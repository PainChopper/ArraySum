# ArraySum - Эффективные стратегии суммирования больших файлов

Этот проект демонстрирует различные подходы к чтению и суммированию большого количества чисел из бинарного файла. Особое внимание уделено производительности и эффективному использованию системных ресурсов.

## Задача

Реализовать различные алгоритмы для подсчета суммы целых чисел (int32), хранящихся в большом бинарном файле (более 1 миллиарда элементов). Каждый алгоритм должен корректно обрабатывать весь файл и возвращать правильную сумму.

## Реализованные стратегии

### 1. Наивная стратегия (SimpleBufferReader)
- Последовательное чтение элементов из файла по одному
- Простота реализации, но низкая производительность
- Не использует дополнительные потоки или буферизацию

### 2. Стратегия с буфером на стеке (ThreadPoolStackBuffer)
- Многопоточное чтение с использованием ThreadPool
- Эффективная буферизация с использованием стекового размещения буфера (Span<byte>)
- Разделение файла на сегменты для параллельной обработки
- Существенное увеличение производительности

## Как использовать

Проект содержит общий интерфейс `ISortStrategy`, который реализуется всеми стратегиями суммирования. Каждая стратегия предоставляет метод:
```csharp
Task<long> Run(CancellationToken token = default)
```

Для добавления новой стратегии необходимо:
1. Создать новый класс в директории SumStrategies 
2. Реализовать интерфейс ISortStrategy
3. Добавить стратегию в список в Program.cs

## Производительность

При тестировании на файле с 1 миллиардом целых чисел наблюдались следующие результаты:
- Наивная стратегия: ~30 секунд
- Стратегия с буфером на стеке: ~1 секунда

## Особенности реализации

При реализации многопоточных стратегий следует обратить внимание на:
- Правильное распределение диапазонов чтения (без пересечений и пропусков)
- Эффективное использование буферизации
- Корректную обработку границ чтения для избежания дублирования данных
- Контроль за суммарным количеством обработанных элементов

## Технические требования

- .NET 7.0 или выше
- Достаточное количество доступной памяти для обработки файла
